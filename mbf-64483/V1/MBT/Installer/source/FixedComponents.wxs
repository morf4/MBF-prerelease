<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment>
    <ComponentGroup Id="FileAssociations">

      <ComponentRef Id="Fasta_FaFileAssociation" />
      <ComponentRef Id="Fasta_MpfaFileAssociation" />
      <ComponentRef Id="Fasta_FnaFileAssociation" />
      <ComponentRef Id="Fasta_FaaFileAssociation" />
      <ComponentRef Id="Fasta_FsaFileAssociation" />
      <ComponentRef Id="Fasta_FasFileAssociation" />
      <ComponentRef Id="Fasta_FastaFileAssociation" />


      <ComponentRef Id="Fastq_FqFileAssociation" />
      <ComponentRef Id="Fastq_FastqFileAssociation" />
      
      <ComponentRef Id="GffFileAssociation" />

      <ComponentRef Id="Genbank_GbFileAssociation" />
      <ComponentRef Id="Genbank_GbkFileAssociation" />
      <ComponentRef Id="Genbank_GenbankFileAssociation" />
    </ComponentGroup>
    
    <DirectoryRef Id='SequenceAssemblerFolder'>

      <!--Readme document-->
      <Component Id='ReadmeDocument' Guid='74466A67-DA55-4AC5-8445-A26BB9C17B25'>
        <File Id='readme.txt' KeyPath='yes' Source='SourceDir\readme.txt'/>
        <RemoveFile Id='RemoveLogFiles' On='uninstall' Name='*.log'/>
      </Component>

      <!-- FASTA file type associations -->
      <!--create .fa file association-->
      <Component Id="Fasta_FaFileAssociation" DiskId="1" Guid="2B12D51C-A54A-4482-926B-E9204A53B099">
        <Condition>FASTA_FA</Condition>
        <ProgId Id="MSRSequenceAsssembler.fa" Description="!(loc.Fasta_FaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fa" ContentType="application/fa">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFa" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fa\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .mpfa file association-->
      <Component Id="Fasta_MpfaFileAssociation" DiskId="1" Guid="C3361306-E134-4C40-8DBC-A459DFA15E59">
        <Condition>FASTA_MPFA</Condition>
        <ProgId Id="MSRSequenceAsssembler.mpfa" Description="!(loc.Fasta_MpfaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="mpfa" ContentType="application/mpfa">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideMpfa" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.mpfa\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .fna file association-->
      <Component Id="Fasta_FnaFileAssociation" DiskId="1" Guid="20F240D2-83C7-4159-823F-0D06C89C5141">
        <Condition>FASTA_FNA</Condition>
        <ProgId Id="MSRSequenceAsssembler.fna" Description="!(loc.Fasta_FnaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fna" ContentType="application/fna">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFna" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fna\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .faa file association-->
      <Component Id="Fasta_FaaFileAssociation" DiskId="1" Guid="34C7CDF3-3AFD-4FA1-BC04-17D6177A6DC0">
        <Condition>FASTA_FAA</Condition>
        <ProgId Id="MSRSequenceAsssembler.faa" Description="!(loc.Fasta_FaaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="faa" ContentType="application/faa">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFaa" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.faa\UserChoice"/>
        <CreateFolder/>
      </Component>
      
      <!--create .fsa file association-->
      <Component Id="Fasta_FsaFileAssociation" DiskId="1" Guid="32E0FA74-A895-4F24-AA91-E4CF7713640C">
        <Condition>FASTA_FSA</Condition>
        <ProgId Id="MSRSequenceAsssembler.fsa" Description="!(loc.Fasta_FsaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fsa" ContentType="application/fsa">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFsa" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fsa\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .fas file association-->
      <Component Id="Fasta_FasFileAssociation" DiskId="1" Guid="483FD8D3-15D1-4CD4-8D86-6AAFDB0904D5">
        <Condition>FASTA_FAS</Condition>
        <ProgId Id="MSRSequenceAsssembler.fas" Description="!(loc.Fasta_FasFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fas" ContentType="application/fas">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFas" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fas\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .fasta file association-->
      <Component Id="Fasta_FastaFileAssociation" DiskId="1" Guid="6C8DF702-7811-4875-A021-6BC77C179ACD">
        <Condition>FASTA_FASTA</Condition>
        <ProgId Id="MSRSequenceAsssembler.fasta" Description="!(loc.Fasta_FastaFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fasta" ContentType="application/fasta">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFasta" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fasta\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!-- FASTQ file type associations -->
      <!--create .fq file association-->
      <Component Id="Fastq_FqFileAssociation" DiskId="1" Guid="7E6146CB-51CA-47D2-9411-5FF75B3529E6">
        <Condition>FASTQ_FQ</Condition>
        <ProgId Id="MSRSequenceAsssembler.fq" Description="!(loc.Fastq_FqFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fq" ContentType="application/fq">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFq" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fq\UserChoice"/>
        <CreateFolder/>
      </Component>
      
      <!--create .fastq file association-->
      <Component Id="Fastq_FastqFileAssociation" DiskId="1" Guid="36DA6A40-4955-4F90-85C1-8CABCDE2D45E">
        <Condition>FASTQ_FASTQ</Condition>
        <ProgId Id="MSRSequenceAsssembler.fastq" Description="!(loc.Fastq_FastqFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="fastq" ContentType="application/fastq">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideFastq" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.fastq\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!-- GFF file type associations -->
      <!--create .gff file association-->
      <Component Id="GffFileAssociation" DiskId="1" Guid="8740CDDA-251D-497E-888C-CF58EEFE0F1F">
        <Condition>GFF_GFF</Condition>
        <ProgId Id="MSRSequenceAsssembler.gff" Description="!(loc.GffFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="gff" ContentType="application/gff">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideGff" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.gff\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!-- GENBANK file type associations -->
      <!--create .gb file association-->
      <Component Id="Genbank_GbFileAssociation" DiskId="1" Guid="C6ACC14C-9015-4D71-BF30-B9F34F020077">
        <Condition>GENBANK_GB</Condition>
        <ProgId Id="MSRSequenceAsssembler.gb" Description="!(loc.Genbank_GbFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="gb" ContentType="application/gb">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideGb" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.gb\UserChoice" />
        <CreateFolder/>
      </Component>

      <!--create .gbk file association-->
      <Component Id="Genbank_GbkFileAssociation" DiskId="1" Guid="5299EA93-6E42-46B4-9B78-55E8CADB64D1">
        <Condition>GENBANK_GBK</Condition>
        <ProgId Id="MSRSequenceAsssembler.gbk" Description="!(loc.Genbank_GbkFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="gbk" ContentType="application/gbk">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideGbk" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.gbk\UserChoice"/>
        <CreateFolder/>
      </Component>

      <!--create .genbank file association-->
      <Component Id="Genbank_GenbankFileAssociation" DiskId="1" Guid="329061E5-B93A-4712-B4A5-4F9E5AC98105">
        <Condition>GENBANK_GENBANK</Condition>
        <ProgId Id="MSRSequenceAsssembler.genbank" Description="!(loc.Genbank_GenbankFileType)" Icon="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED">
          <Extension Id="genbank" ContentType="application/genbank">
            <Verb Id="open" Command="open" TargetFile="fil78C17DA2D0CEBF9D52A1F0B6FAC1B2ED" Argument="&quot;%1&quot;"/>
          </Extension>
        </ProgId>
        <RemoveRegistryKey Id="OverrideGenbank" Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.genbank\UserChoice"/>
        <CreateFolder/>
      </Component>

    </DirectoryRef>
    </Fragment>
</Wix>
